### Helper function and classes go here.